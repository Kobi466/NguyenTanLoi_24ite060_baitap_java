package Week3_IOStream;import java.io.File;import java.io.FileOutputStream;import java.io.IOException;import java.io.RandomAccessFile;import java.util.concurrent.*;class FileReadTask implements Callable<byte[]> {    File file;    long head;    int size;    public FileReadTask(File file, long head, int size) {        this.file = file;        this.head = head;        this.size = size;    }    @Override    public byte[] call() throws Exception {        RandomAccessFile randomAccessFile = new RandomAccessFile(file, "r");// mo file ngau nhien        randomAccessFile.seek(head);// di chuyen den dau file        byte[] buffer = new byte[size];// toan bo nho dem chua du lieu doc        int read = randomAccessFile.read(buffer);///doc du lieu file vao buffer        randomAccessFile.close();        if(read == size){            return buffer;        }else {            return java.util.Arrays.copyOf(buffer, read);        }    }}public class ex2 {    private static final int kickThuocTep = 1024 * 1024;    public static void main(String[] args) throws IOException {        File filevao = new File("C:\\Users\\ADMIN\\Documents\\TepText\\filevaoex2.txt");        File filera = new File("C:\\Users\\ADMIN\\Documents\\TepText\\fileraex2.txt");        RandomAccessFile randomAccessFile = new RandomAccessFile(filevao, "r");        long sizeFile = (int) randomAccessFile.length();        randomAccessFile.close();        int phanChia = (int) Math.ceil((double)sizeFile/ kickThuocTep);//tinh so phan can chia        ExecutorService executorService = Executors.newFixedThreadPool(4);//tao 4 luong        Future<byte[]>[] future = new Future[phanChia];        //khoi tao tung luong de doc du lieu cua file        for (int i = 0; i < phanChia; i++) {            long start = (long) i * kickThuocTep;//vi tri bat dau cua phan nay            int size = (int) Math.min(kickThuocTep, sizeFile-start);//do dai phan doc            future[i] = executorService.submit(new FileReadTask(filevao, start, size));        }        //ghi du lieu vao file moi theo dung thu tu        try{            FileOutputStream fileOutputStream = new FileOutputStream(filera);            for(Future<byte[]> future1 : future){                fileOutputStream.write(future1.get());//lay du lieu tun g phan roi ghi vao file            }        }catch (IOException e){            e.printStackTrace();        } catch (ExecutionException e) {            throw new RuntimeException(e);        } catch (InterruptedException e) {            throw new RuntimeException(e);        }        executorService.shutdown();    }}